![thumbnail](./thumb.png)

# Pipeline Action

ì´ ì €ì¥ì†ŒëŠ” í–‰ë™ ì¶”ì • ëª¨ë¸ì„ í•™ìŠµì‹œí‚¤ê¸° ìœ„í•œ ë°ì´í„°ì…‹ì„ êµ¬ì¶•í•˜ëŠ” ëª¨ë“ˆì„ ì œê³µí•©ë‹ˆë‹¤.

### Note

ëª¨ë“  í…ŒìŠ¤íŠ¸ëŠ” ë‹¤ìŒ í™˜ê²½ì—ì„œ ì§„í–‰ë˜ì—ˆìŠµë‹ˆë‹¤. ì¼ë¶€ í™˜ê²½ì—ì„œëŠ” ë²„ì „ í˜¸í™˜ì„± í™•ì¸ì´ í•„ìš”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

    CPU: Intel(R) Core(TM) i9-13900KF
    GPU: Nvidia GeForce RTX 4090, CUDA 12.1
    OS: Ubuntu 24.04 LTS
    Conda: 25.5.1

## Installation

ì´ ì €ì¥ì†Œì—ì„œ ì œê³µí•˜ëŠ” ëª¨ë“ˆì„ ì‹¤í–‰í•˜ê¸° ìœ„í•´ Conda ê¸°ë°˜ í™˜ê²½ì„ êµ¬ì„±í•©ë‹ˆë‹¤.

ë§Œì•½, Condaê°€ ì„¤ì¹˜ë˜ì–´ ìˆì§€ ì•Šë‹¤ë©´ ì•„ë˜ ë§í¬ì— ì ‘ì†í•˜ì—¬ ì„¤ì¹˜ í›„ ë‹¨ê³„ë¥¼ ì§„í–‰í•©ë‹ˆë‹¤.

[ğŸ”— ì•„ë‚˜ì½˜ë‹¤ ë‹¤ìš´ë¡œë“œ](https://www.anaconda.com/download/success) ë˜ëŠ” [ğŸ”— ë¯¸ë‹ˆì½˜ë‹¤ ë‹¤ìš´ë¡œë“œ](https://www.anaconda.com/docs/getting-started/miniconda/main)

**Step 1**. Conda ê°€ìƒí™˜ê²½ ìƒì„± ë° í™œì„±í™”

```bash
conda create --name ngc-pipe-action python=3.8 -y
conda activate ngc-pipe-action
```

**Step 2**. ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜

```bash
pip install -r requirements.txt
pip install -v -e .
```

**Step 3**. MMLab ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜

```bash
pip install -U openmim
mim install mmengine==0.10.7
mim install mmcv==2.1.0
mim install mmdet==3.3.0
```

## Directory Structure

```
.
â”œâ”€â”€ configs             : ëª¨ë¸ ì„¤ì • ê´€ë ¨ ë””ë ‰í† ë¦¬
â”œâ”€â”€ data
â”‚   â”œâ”€â”€ input           : ì›ë³¸ ë™ì˜ìƒ ë””ë ‰í† ë¦¬
â”‚   â””â”€â”€ output          : ì²˜ë¦¬ ê²°ê³¼ ë””ë ‰í† ë¦¬
â”œâ”€â”€ mmpose              : mmpose ëª¨ë“ˆ
â”œâ”€â”€ model-index.yml     : í˜¸í™˜ ëª¨ë¸ ëª©ë¡
â”œâ”€â”€ requirements.txt    : ë¼ì´ë¸ŒëŸ¬ë¦¬ ëª©ë¡
â”œâ”€â”€ run.py              : ë©”ì¸ ì½”ë“œ
â”œâ”€â”€ setup.cfg           : í™˜ê²½ ì„¤ì • íŒŒì¼
â”œâ”€â”€ setup.py            : í™˜ê²½ ì„¤ì • íŒŒì¼
â””â”€â”€ requirements        : ë¼ì´ë¸ŒëŸ¬ë¦¬ ëª©ë¡ ë””ë ‰í† ë¦¬
```

## Run

ë°ì´í„°ì…‹ êµ¬ì¶•ì„ ìœ„í•´ ì•„ë˜ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.

```bash
python run.py --pose2d rtmo
```

`run.py`ëŠ” ì•„ë˜ ë‹¨ê³„ë¥¼ ê±°ì³ ë°ì´í„°ì…‹ì„ êµ¬ì¶•í•©ë‹ˆë‹¤.

**Step 1**. ì¸ì ì„¤ì •: ëª¨ë¸ ì´ˆê¸°í™” ì¸ìì™€ í˜¸ì¶œ ì¸ìë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.

**Step 2**. ë™ì˜ìƒ ë¡œë“œ: `data/input` ë””ë ‰í† ë¦¬ì—ì„œ `.mp4`, `.avi`, `.mov` íŒŒì¼ë“¤ì„ ì°¾ì•„ ë™ì˜ìƒ ëª©ë¡(íŒŒì¼ ê²½ë¡œ)ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.

**Step 3**. í¬ì¦ˆ ì¶”ë¡ : ë™ì˜ìƒ ëª©ë¡ì˜ ë™ì˜ìƒì—ì„œ í¬ì¦ˆë¥¼ ì¶”ë¡ í•©ë‹ˆë‹¤. ì´ í¬ì¦ˆëŠ” COCO Keypoint í‘œê¸°ë²•ì„ ë”°ë¦…ë‹ˆë‹¤.

-   `output/pose`: í”„ë ˆì„ë³„ BBOX/í¬ì¦ˆë¡œ êµ¬ì„±ëœ `json`íŒŒì¼
-   `output/vis`: ì›ë³¸ ì˜ìƒ ìœ„ì— í¬ì¦ˆ ì •ë³´ê°€ ì˜¤ë²„ë©ëœ ë™ì˜ìƒ íŒŒì¼

**Step 4**. ë°ì´í„°ì…‹ ë³€í™˜: `Step 3`ì—ì„œ ìƒì„±ëœ í¬ì¦ˆ ë°ì´í„°`data/output/pose`ë¥¼ í•™ìŠµ ë°ì´í„°ì…‹ í˜•ì‹ìœ¼ë¡œ ë³€í™˜í•©ë‹ˆë‹¤.

-   `output/dataset.pkl`: í•™ìŠµ ë°ì´í„°ì…‹ í˜•ì‹ìœ¼ë¡œ ë³€í™˜ëœ `pickle`íŒŒì¼

## Train Dataset Structure

```python
dataset = {
    'split': {
        'train': [], # í•™ìŠµìš© ë™ì˜ìƒ íŒŒì¼ëª…
        'val': [], # ê²€ì¦ìš© ë™ì˜ìƒ íŒŒì¼ëª…
    },
    'annotations': [
        {
            'frame_dir': '', # ë™ì˜ìƒ ì´ë¦„
            'label': '', # ë ˆì´ë¸”
            'img_shape': (0, 0), # ì´ë¯¸ì§€ í¬ê¸°
            'original_shape': (0, 0), # ì›ë³¸ í¬ê¸°
            'total_frames': 0, # ì´ í”„ë ˆì„ ìˆ˜
            'keypoint': [], # í‚¤í¬ì¸íŠ¸
            'keypoint_score': [] # í‚¤í¬ì¸íŠ¸ ì •í™•ë„ ì ìˆ˜
        },
        ...
    ]
}
```
